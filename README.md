# ðŸš—  â€” Ð¡ÐµÑ€Ð²Ð¸Ñ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð° Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»ÐµÐ¹

## ðŸ“‹ ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ

Ð­Ñ‚Ð¾ Ð±Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… ÑÐµÑ€Ð²Ð¸ÑÐ° Ð´Ð»Ñ ÑƒÐ´Ð¾Ð±Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð° Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»ÐµÐ¹ Ð¿Ð¾ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ð¼ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ð¼. ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¼Ð¾Ð¶ÐµÑ‚ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð°Ð²Ñ‚Ð¾ Ð¿Ð¾ Ð¼Ð°Ñ€ÐºÐµ, Ð¼Ð¾Ð´ÐµÐ»Ð¸, Ð³Ð¾Ð´Ñƒ Ð²Ñ‹Ð¿ÑƒÑÐºÐ°, Ñ†ÐµÐ½Ðµ Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ð¼ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¸ÑÑ‚Ð¸ÐºÐ°Ð¼. Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð¾Ð²Ð°Ð½Ñ‹ Ð² Ð±Ð°Ð·Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð¸ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð¸ÑÐºÐ°.

## ðŸ“‚ ÐœÐ¾Ð´ÐµÐ»ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ñ…
Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð° Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ SQL. ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹:

**ÐœÐ°Ñ€ÐºÐ¸** (brands): ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð±Ñ€ÐµÐ½Ð´Ð° (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, BMW, Audi)

**ÐœÐ¾Ð´ÐµÐ»Ð¸** (models): ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸, Ñ‚Ð¸Ð¿ ÐºÑƒÐ·Ð¾Ð²Ð°, ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ¸Ð´ÐµÐ½Ð¸Ð¹, Ð¿Ñ€Ð¸Ð²Ð¾Ð´

**ÐÐ²Ñ‚Ð¾ÑÐ°Ð»Ð¾Ð½Ñ‹** (dealerships): ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð°Ð²Ñ‚Ð¾ÑÐ°Ð»Ð¾Ð½Ð°, ÐµÐ³Ð¾ Ð°Ð´Ñ€ÐµÑ, ÐµÑÑ‚ÑŒ Ð»Ð¸ ÑƒÑÐ»ÑƒÐ³Ð° Ñ‚Ñ€ÐµÐ¹Ð´ Ð¸Ð½

**Ð”Ð²Ð¸Ð³Ð°Ñ‚ÐµÐ»Ð¸** (engines): ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð´Ð²Ð¸Ð³Ð°Ñ‚ÐµÐ»Ñ, Ñ‚Ð¸Ð¿, ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ hp, ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ñ†Ð¸Ð»Ð¸Ð½Ð´Ñ€Ð¾Ð², Ð¾Ð±ÑŠÐµÐ¼ 

**ÐŸÐ¾ÐºÑƒÐ¿ÐºÐ¸** (purchases): ÐŸÑ€Ð¾Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ð°Ð²Ñ‚Ð¾, Ð¸Ñ… ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾, Ð°Ð²Ñ‚Ð¾ÑÐ°Ð»Ð¾Ð½, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð´Ð°Ð» Ð°Ð²Ñ‚Ð¾

Ð¡Ð²ÑÐ·Ð¸ Ð¼ÐµÐ¶Ð´Ñƒ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð°Ð¼Ð¸: Ð¼Ð½Ð¾Ð³Ð¸Ðµ ÐºÐ¾ Ð¼Ð½Ð¾Ð³Ð¸Ð¼, Ð¾Ð´Ð¸Ð½ ÐºÐ¾ Ð¼Ð½Ð¾Ð³Ð¸Ð¼. Ð¢Ð°Ðº, Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ñƒ Ð¾Ð´Ð½Ð¾Ð¹ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ð°Ð²Ñ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ñ… Ð´Ð²Ð¸Ð³Ð°Ñ‚ÐµÐ»ÐµÐ¹, Ð° Ð¾Ð´Ð¸Ð½ Ð´Ð²Ð¸Ð³Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð¼Ð¾Ð¶ÐµÑ‚ ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°Ñ‚ÑŒÑÑ Ð½Ð° Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹ Ð°Ð²Ñ‚Ð¾(m:m). Ð£ Ð¾Ð´Ð½Ð¾Ð¹ Ð¼Ð°Ñ€ÐºÐ¸ Ð°Ð²Ñ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹, Ð¾Ð´Ð½Ð°ÐºÐ¾ Ñƒ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð´Ð½Ð° Ð¼Ð°Ñ€ÐºÐ°(1:m). 
Ð”Ð»Ñ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ ÑÐ²ÑÐ·ÐµÐ¹ m:m Ð±Ñ‹Ð»Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ Ð²ÑÐ¿Ð¾Ð¼Ð¾Ð³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹:
1. dealership_brand
2. model_engine

Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð²ÐµÐ´ÐµÐ½Ð° Ðº 3 Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ñ„Ð¾Ñ€Ð¼Ðµ.

## ðŸ“Š SQL-Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾ÑÐµÑ€Ð²Ð¸ÑÐ°

### ðŸ”¹ Ð›ÐµÐ³ÐºÐ¸Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹  
- ÐÐµÐ¼ÐµÑ†ÐºÐ¸Ðµ Ð¼Ð°Ñ€ÐºÐ¸ Ð°Ð²Ñ‚Ð¾  
- Ð¡Ð°Ð¼Ð°Ñ ÑÑ‚Ð°Ñ€Ð°Ñ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð°Ð²Ñ‚Ð¾  
- Ð¡Ñ€ÐµÐ´Ð½ÑÑ Ñ†ÐµÐ½Ð° Ð²ÑÐµÑ… Ð°Ð²Ñ‚Ð¾  
- ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð°Ð²Ñ‚Ð¾ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ñ‚Ð¸Ð¿Ð°  

### ðŸ”¸ Ð¡Ñ€ÐµÐ´Ð½Ð¸Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹  
- ÐÐ²Ñ‚Ð¾, ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ðµ ÐºÑƒÐ¿Ð¸Ð»Ð¸ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð²ÑÐµÑ… Ð² Ð¾Ð´Ð¸Ð½ Ð´ÐµÐ½ÑŒ  
- ÐÐ²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»Ð¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð½Ðµ Ð¿Ð¾ÐºÑƒÐ¿Ð°Ð»Ð¸ Ð² 2023 Ð³Ð¾Ð´Ñƒ  
- ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹ Ð°Ð²Ñ‚Ð¾, Ð¿Ñ€Ð¾Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð² Ð´ÐµÐºÐ°Ð±Ñ€Ðµ 2023 Ð³Ð¾Ð´Ð°  

### ðŸ”º Ð¡Ð»Ð¾Ð¶Ð½Ñ‹Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹  
- ÐžÐ±Ñ‰ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹, ÐºÑƒÐ¿Ð»ÐµÐ½Ð½Ñ‹Ñ… Ð² 2023 Ð³Ð¾Ð´Ñƒ, Ð¾Ñ‚ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ðµ Ð² Ð¿Ð¾Ñ€ÑÐ´ÐºÐµ ÑƒÐ±Ñ‹Ð²Ð°Ð½Ð¸Ñ  
- ÐÐ²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»Ð¸ Ñ Ð¿Ð¾Ð»Ð½Ñ‹Ð¼ Ð¿Ñ€Ð¸Ð²Ð¾Ð´Ð¾Ð¼ Ð¸ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾Ð¼ ÑÐ¸Ð´ÐµÐ½Ð¸Ð¹ Ð±Ð¾Ð»ÑŒÑˆÐµ 5, Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ð´Ð¸Ð»ÐµÑ€ÑÐºÐ¸Ðµ Ñ†ÐµÐ½Ñ‚Ñ€Ñ‹, Ð³Ð´Ðµ Ð¾Ð½Ð¸ Ð¿Ñ€Ð¾Ð´Ð°ÑŽÑ‚ÑÑ  
- Ð¦ÐµÐ½Ð° Ð¸ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð°Ð²Ñ‚Ð¾ Ñ Ð¼Ð¾Ñ‰Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð´Ð²Ð¸Ð³Ð°Ñ‚ÐµÐ»Ñ Ð²Ñ‹ÑˆÐµ ÑÑ€ÐµÐ´Ð½ÐµÐ¹  


### Ð›ÐµÐ³ÐºÐ¸Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹
**1. ÐÐµÐ¼ÐµÑ†ÐºÐ¸Ðµ Ð¼Ð°Ñ€ÐºÐ¸ Ð°Ð²Ñ‚Ð¾**:
```sql
SELECT brand_name
FROM brands
WHERE country_of_foundation=â€™Ð“ÐµÑ€Ð¼Ð°Ð½Ð¸Ñâ€™
```
**2. Ð¡Ð°Ð¼Ð¾Ðµ ÑÑ‚Ð°Ñ€Ð¾Ðµ Ð°Ð²Ñ‚Ð¾**
```sql
SELECT model_name
FROM models
WHERE release_date =
  (SELECT MIN(release_date)
  FROM models);
```
**3. Ð¡Ñ€ÐµÐ´Ð½ÑÑ Ñ†ÐµÐ½Ð° Ð°Ð²Ñ‚Ð¾**
```sql
SELECT round(AVG(price),1)
FROM model_engine;
```
**4. ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð°Ð²Ñ‚Ð¾ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ñ‚Ð¸Ð¿Ð°**
```sql
SELECT type_of_car, COUNT(*) AS model_count
FROM models
GROUP BY type_of_car;
```

### Ð¡Ñ€ÐµÐ´Ð½Ð¸Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹
**1. ÐÐ²Ñ‚Ð¾, ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ðµ ÐºÑƒÐ¿Ð¸Ð»Ð¸ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð²ÑÐµÑ… Ð² Ð¾Ð´Ð¸Ð½ Ð´ÐµÐ½ÑŒ**
```sql
SELECT brand_name, model_name, amount
FROM
models
  INNER JOIN brands ON brands.id_brand=models.id_brand
  INNER JOIN purchases ON models.id_model=purchases.id_model
  WHERE amount = (SELECT MAX(amount) from purchases);
```
**2. ÐÐ²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»Ð¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð½Ðµ Ð¿Ð¾ÐºÑƒÐ¿Ð°Ð»Ð¸ Ð² 2023 Ð³Ð¾Ð´Ñƒ.**
```sql
SELECT brand_name, model_name, amount
FROM
  models
  INNER JOIN brands ON brands.id_brand=models.id_brand
  LEFT JOIN purchases ON purchases.id_model=models.id_model
  WHERE amount IS NULL;
```
**3. ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹ Ð°Ð²Ñ‚Ð¾, Ð¿Ñ€Ð¾Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð² Ð´ÐµÐºÐ°Ð±Ñ€Ðµ 2023**
```sql
SELECT
  models.model_name,
  SUM(purchases.amount) AS count_sold
FROM
  models
  INNER JOIN purchases ON models.id_model = purchases.id_model
WHERE
  purchases.date_of_purchase>'30-11-2023'
GROUP BY
  models.model_name;
```

### Ð¡Ð»Ð¾Ð¶Ð½Ñ‹Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹
**1. ÐžÐ±Ñ‰ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹, ÐºÑƒÐ¿Ð»ÐµÐ½Ð½Ñ‹Ñ… Ð² 2023 Ð³Ð¾Ð´Ñƒ, Ð¾Ñ‚ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ðµ Ð²
Ð¿Ð¾Ñ€ÑÐ´ÐºÐµ ÑƒÐ±Ñ‹Ð²Ð°Ð½Ð¸Ñ**
```sql
SELECT brand_name, model_name, total_purchases
FROM brands
INNER JOIN models ON brands.id_brand = models.id_brand
INNER JOIN (
SELECT id_model, SUM(amount) AS total_purchases
FROM purchases
GROUP BY id_model
) AS purchase_counts ON models.id_model = purchase_counts.id_model
ORDER BY total_purchases DESC;
```
**2. Ð’Ñ‹Ð²ÐµÑÑ‚Ð¸ Ð°Ð²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»Ð¸ Ñ Ð¿Ð¾Ð»Ð½Ñ‹Ð¼ Ð¿Ñ€Ð¸Ð²Ð¾Ð´Ð¾Ð¼, ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾Ð¼ ÑÐ¸Ð´ÐµÐ½ÐµÐ¹ Ð±Ð¾Ð»ÑŒÑˆÐµ 5
Ð¸ Ð´Ð¸Ð»ÐµÑ€ÑÐºÐ¸Ðµ Ñ†ÐµÐ½Ñ‚Ñ€Ñ‹, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð¾Ð½Ð¸ Ð¿Ñ€Ð¾Ð´Ð°ÑŽÑ‚ÑÑ.**
```sql
SELECT dealership_name, brand_name, model_name, num_of_seats
FROM
dealerships
LEFT JOIN dealership_brand ON
dealerships.id_dealership=dealership_brand.id_dealership
LEFT JOIN brands ON dealership_brand.id_brand=brands.id_brand
LEFT JOIN models ON models.id_brand=brands.id_brand
WHERE
(drive='Ð¿Ð¾Ð»Ð½Ñ‹Ð¹' and num_of_seats>5)
ORDER BY num_of_seats DESC;
```

**3. Ð’Ñ‹Ð²ÐµÑÑ‚Ð¸ Ñ†ÐµÐ½Ñƒ Ð¸ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð°Ð²Ñ‚Ð¾ Ñ Ð¼Ð¾Ñ‰Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð´Ð²Ð¸Ð³Ð°Ñ‚ÐµÐ»Ñ Ð²Ñ‹ÑˆÐµ ÑÑ€ÐµÐ´Ð½ÐµÐ¹)**
```sql
SELECT brand_name, model_name,engine_power, price
FROM
models
LEFT JOIN brands ON brands.id_brand=models.id_brand
LEFT JOIN model_engine ON models.id_model=model_engine.id_model
LEFT JOIN engines ON engines.id_engine=model_engine.id_engine
WHERE engine_power>(SELECT AVG(engine_power) FROM engines)
ORDER BY price;
```

